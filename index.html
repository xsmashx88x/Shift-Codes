<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="shortcut icon" type="image/png" href="https://xsmashx88x.github.io/Shift-Codes/smashfavicon.png">
    <link rel="icon" type="image/png" href="https://xsmashx88x.github.io/Shift-Codes/smashfavicon.png">
    <div class="scrolling-banner">
        <div class="scrolling-text">• FAV AND CHECK BACK DAILY<br> (Refresh Page Every Once In Awhile)<br>• Any Issues Contact Me Via Links Below •</div>
    </div>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SHiFT Codes - Tracker + More</title>
    
    <!-- Open Graph tags -->
    <meta property="og:title" content="SHiFT Codes - Tracker + More">
    <meta property="og:description" content="Track and manage Borderlands SHiFT codes + More">
    <meta property="og:type" content="website">
    
    <!-- Twitter Card tags -->
    <meta name="twitter:title" content="SHiFT Codes - Tracker + More">
    <meta name="twitter:description" content="Track and manage Borderlands SHiFT codes + More">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@400;600;700&display=swap');
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Chakra Petch', sans-serif;
            text-align: center;
            padding: 20px;
            background: #2c1b2d;
            color: #fff;
            min-height: 100vh;
            background-image: 
                radial-gradient(circle at 20% 30%, #3d2942 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, #482c4d 0%, transparent 50%);
        }
        
        .container {
            max-width: 650px;
            margin: 0 auto;
            background: rgba(35, 25, 40, 0.9);
            padding: 25px;
            border-radius: 5px;
            box-shadow: 0 0 15px rgba(255, 198, 0, 0.4);
            border: 2px solid #ffc600;
            position: relative;
            overflow: hidden;
        }
        
        .container:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #ffc600, #ff7c00, #ffc600);
            box-shadow: 0 0 10px #ffc600;
        }
        
        h1 {
            color: #ffc600;
            margin-bottom: 15px;
            font-size: 36px;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: 2px 2px 0 #000, 0 0 10px rgba(255, 198, 0, 0.7);
            font-weight: 700;
        }
        
        h2 {
            color: #ffc600;
            margin: 25px 0 12px 0;
            padding-bottom: 8px;
            border-bottom: 2px solid #ff7c00;
            font-size: 22px;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-shadow: 1px 1px 0 #000;
        }
        
        /* Social links styling |||||||||||||||||||||||||*/
        .social-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 15px 0 25px 0;
            flex-wrap: wrap;
        }
        
        .social-links a {
            color: #ffc600;
            text-decoration: none;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.3s;
            text-shadow: 1px 1px 0 #000;
            padding: 8px 12px;
            border-radius: 4px;
            background: rgba(20, 15, 25, 0.7);
            border: 1px solid #ff7c00;
        }
        
        .social-links a:hover {
            color: #ff7c00;
            text-shadow: 0 0 5px #ff7c00;
            background: rgba(255, 124, 0, 0.2);
            transform: translateY(-2px);
        }
        
        .code-box {
            background: linear-gradient(135deg, #3A2A1A, #5C3C10); /* Gold-themed */
            color: white;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
            text-align: left;
            transition: transform 0.2s;
            border: 2px solid #D4A017; 
            box-shadow: 0 0 8px rgba(212, 160, 23, 0.3); 
            position: relative;
        }

        .code-box:hover {
            transform: translateY(-3px);
            box-shadow: 0 0 12px rgba(255, 179, 71, 0.5); 
        }
       
        .permanent-code-box {
            background: linear-gradient(135deg, #1b3b6a 0%, #0f2552 100%);
            color: white;
            padding: 12px 15px;
            margin: 10px 0;
            border-radius: 4px;
            text-align: left;
            transition: transform 0.2s;
            border: 1px solid #4a90e2;
            box-shadow: 0 0 4px rgba(74, 144, 226, 0.4);
            position: relative;
        }
        
        .permanent-code-box:hover {
            transform: translateY(-1px);
            box-shadow: 0 0 6px rgba(74, 144, 226, 0.6);
        }
/* New style for Black Market Vendor |||||||||||||||||||||||||*/
        .black-market-code-box { /* New style for Black Market Vendor |||||||||||||||||||||||||*/
            background: linear-gradient(135deg, #4d0000, #2d0000); /* Dark red/black */
            border: 2px solid #ff4444; /* Red border */
            box-shadow: 0 0 8px rgba(255, 68, 68, 0.3);
            color: #ffcccc; /* Default text color */
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
            text-align: left;
            transition: transform 0.2s;
            position: relative;
        }
        .black-market-code-box:hover {
            transform: translateY(-3px);
            box-shadow: 0 0 12px rgba(255, 68, 68, 0.5);
        }
        .black-market-code-box .code-text { color: #ffaa99; }
        .black-market-code-box .title-container { color: #ff9999; }
        .black-market-code-box .expire-date { color: #ffcccc; }
        .black-market-code-box .countdown {
            color: #ffaaaa;
            border: 1px solid #ffaaaa;
        }
        /* Redeemed style for black market vendor */
        .black-market-code-box.redeemed {
            opacity: 0.7;
            position: relative;
        }
        .black-market-code-box.redeemed::after {
            content: "REDEEMED";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-15deg);
            font-size: 24px;
            font-weight: bold;
            color: #7cff7c; /* Green checkmark color */
            text-shadow: 2px 2px 0 #000, 0 0 10px rgba(124, 255, 124, 0.7);
            z-index: 10;
            pointer-events: none;
        }
        .black-market-code-box.redeemed .code-text {
            color: #7cff7c !important;
        }
        
        .expired-code-box {
            background: linear-gradient(135deg, #5a2c2c 0%, #3a1c1c 100%);
            color: #ff9999;
            padding: 15px;
            margin: 12px 0;
            border-radius: 4px;
            text-align: left;
            border: 2px solid #ff4444;
            box-shadow: 0 0 5px rgba(255, 68, 68, 0.3);
            position: relative;
        }
        
        .expired-code-box .code-text {
            color: #ff6666;
            text-shadow: 1px 1px 0 #400000;
        }
        
        .expired-code-box .title-container {
            color: #ff9999;
        }
        
        .expired-code-box .expire-date {
            color: #ffaaaa;
        }
        
        .expired-code-box.redeemed {
            background: linear-gradient(135deg, #2c5a2c 0%, #1c3a1c 100%);
            border: 2px solid #44ff44;
            box-shadow: 0 0 5px rgba(68, 255, 68, 0.3);
        }
        
        .expired-code-box.redeemed .code-text {
            color: #7cff7c !important;
            text-shadow: 1px 1px 0 #004000;
        }
        
        .expired-code-box.redeemed .title-container {
            color: #9eff9e;
        }
        
        .expired-code-box.redeemed .expire-date {
            color: #aaffaa;
        }
        
        .code-text {
            font-family: 'Courier New', monospace;
            font-size: 18px;
            font-weight: bold;
            margin: 12px 0;
            word-break: break-all;
            letter-spacing: 1px;
            color: #ffc600;
            text-shadow: 1px 1px 0 #000;
        }
        
        .permanent-code-text {
            font-family: 'Courier New', monospace;
            font-size: 14px;
            font-weight: bold;
            margin: 0 0 4px 0;
            word-break: break-all;
            letter-spacing: 0.5px;
            color: #ffc600;
            text-shadow: 1px 1px 0 #000, 0 0 5px rgba(255, 198, 0, 0.7);
            line-height: 1.2;
        }
        
        .code-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 10px;
            padding-top: 8px;
            border-top: 1px solid rgba(255, 198, 0, 0.3);
        }
        
        .permanent-code-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 8px;
            padding-top: 5px;
            border-top: 1px solid rgba(107, 168, 255, 0.3);
        }
        
        .small-copy-btn {
            background: linear-gradient(to bottom, #ff7c00, #e56a00);
            border: 1px solid #ffc600;
            color: #fff;
            padding: 6px 12px;
            border-radius: 3px;
            cursor: pointer;
            font-weight: bold;
            margin: 0;
            transition: all 0.3s;
            font-size: 12px;
            text-transform: uppercase;
            font-family: 'Chakra Petch', sans-serif;
            text-shadow: 1px 1px 0 #000;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
            order: 2;
        }
        
        .small-copy-btn:hover {
            background: linear-gradient(to bottom, #ff8c00, #ff6a00);
            transform: scale(1.05);
            box-shadow: 0 0 6px #ffc600;
        }
        
        .permanent-copy-btn {
            background: linear-gradient(to bottom, #4a90e2, #2a70c2);
            border: 1px solid #6ba8ff;
            color: #fff;
            padding: 6px 12px;
            border-radius: 3px;
            cursor: pointer;
            font-weight: bold;
            margin: 0;
            transition: all 0.3s;
            font-size: 12px;
            text-transform: uppercase;
            font-family: 'Chakra Petch', sans-serif;
            text-shadow: 1px 1px 0 #000;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
            order: 2;
        }
        
        .permanent-copy-btn:hover {
            background: linear-gradient(to bottom, #5aa0ff, #3a80e2);
            transform: scale(1.05);
            box-shadow: 0 0 4px #6ba8ff;
        }
        
        .countdown {
            font-size: 14px;
            font-weight: bold;
            color: #ff7c00;
            margin: 8px 0;
            padding: 4px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
            text-shadow: 1px 1px 0 #000;
            border: 1px solid #ff7c00;
        }
        
        .expire-date {
            font-size: 13px;
            color: #ff9e40;
            margin: 4px 0;
            font-style: italic;
            text-shadow: 1px 1px 0 #000;
        }
        
        .permanent-text {
            font-size: 10px;
            color: #6ba8ff;
            margin: 0;
            font-weight: bold;
            text-shadow: 1px 1px 0 #000, 0 0 3px rgba(107, 168, 255, 0.5);
            display: inline-block;
        }
        
        .copied-message {
            color: #7cff7c;
            font-weight: bold;
            display: none;
            margin-left: 5px;
            font-size: 11px;
            text-shadow: 1px 1px 0 #000;
            order: 3;
        }
        
        .permanent-copied-message {
            color: #7cff7c;
            font-weight: bold;
            display: none;
            margin-left: 5px;
            font-size: 11px;
            text-shadow: 1px 1px 0 #000;
            order: 3;
        }
        /* redeem button orange go to shift site ///////////////////*/        
        .rewards-link {
            display: block;
            width: fit-content;            
            background: linear-gradient(to bottom, #ff7c00, #e56a00);
            color: white;
            padding: 2px 24px;
            text-decoration: none;
            border-radius: 4px;
            margin: 10px auto 15px auto;
            font-weight: bold;
            transition: all 0.3s;
            font-size: 14px;
            text-transform: uppercase;
            border: 2px solid #ffc600;
            text-shadow: 1px 1px 0 #000;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.5);
            font-family: 'Chakra Petch', sans-serif;
        }
        
        .rewards-link:hover {
            background: linear-gradient(to bottom, #ff8c00, #ff6a00);
            transform: scale(1.05);
            box-shadow: 0 0 10px #ffc600;
        }
        
        /* BUTTONS SIDE BY SIDE */
        .info-button {
            background: linear-gradient(to bottom, #4a4a4a, #2a2a2a);
            color: white;
            padding: 12px 20px;
            border-radius: 4px;
            margin: 0;
            font-weight: bold;
            transition: all 0.3s;
            font-size: 14px;
            text-transform: uppercase;
            border: 2px solid #888;
            text-shadow: 1px 1px 0 #000;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.5);
            font-family: 'Chakra Petch', sans-serif;
            cursor: pointer;
            display: inline-block;
            width: auto;
            flex: 1;
            min-width: 0;
        }

        .info-button:hover {
            background: linear-gradient(to bottom, #5a5a5a, #3a3a3a);
            transform: scale(1.05);
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.3);
        }

/* Hde Buttons color  |||||||||||||||||||||||||*/
#hideem-toggle-btn {
            background: linear-gradient(to bottom, #B9B9B9, #363337);
            border: 2px solid #888;
        }

#hideem-toggle-btn:hover {
            background: linear-gradient(to bottom, #B9B9B9, #363337);
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.3);
        }

/* (INFO & FAQ) color  |||||||||||||||||||||||||*/
#infofaq-toggle-btn {
            background: linear-gradient(to bottom, #22FEFE, #363337);
            border: 2px solid #adb5bd;
        }

#infofaq-toggle-btn:hover {
            background: linear-gradient(to bottom, #22FEFE, #363337);
            box-shadow: 0 0 8px #adb5bd;
        }

/* CHANGE LOG color an button  |||||||||||||||||||||||||*/
#changlog-toggle-btn {
            margin-top: 1px; /* Adjust this value as needed to lower it more or less */
            background: linear-gradient(to bottom, #537CB9, #363337);
              border: 2px solid #adb5bd;
        }

#changlog-toggle-btn:hover {
            background: linear-gradient(to bottom, #537CB9, #363337);
            box-shadow: 0 0 8px #00ccff;
        }

/* How to redeem color an button  |||||||||||||||||||||||||*/
#redeem-toggle-btn {
    margin-top: 5px;
    background: linear-gradient(to bottom, #00aa00, #0055aa);
    border: 2px solid #00ccff;
}

#redeem-toggle-btn:hover {
    background: linear-gradient(to bottom, #00cc00, #0077cc);
    box-shadow: 0 0 8px #00ccff;
}

        /* Responsive design for mobile |||||||||||||||||||||||||*/
        @media (max-width: 768px) {
            .button-row {
                flex-direction: column;
                align-items: center;
            }
            
            .info-button {
            display: block; /* Default to block for stacking */
            width: fit-content; /* Make width fit content */
            margin: 10px auto; /* Default for stacking: center horizontally, provide vertical space */
            flex-shrink: 0; /* Prevent shrinking when inside flex container */
            }
                    /* Specific adjustments for buttons inside .top-header-buttons */
        .top-header-buttons .info-button {
            margin: 0; /* Remove auto margins when inside flex, let gap handle spacing */
            margin-bottom: 10px; /* Add vertical margin for wrapping on mobile */
        }
        }
        
        /*|||||||||||||||||||||||||*/

        .collapse-btn {
            background: linear-gradient(to bottom, #555, #333);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            margin: 8px 0;
            transition: all 0.3s;
            font-size: 14px;
            text-transform: uppercase;
            border: 1px solid #666;
            text-shadow: 1px 1px 0 #000;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            font-family: 'Chakra Petch', sans-serif;
        }
        
        .collapse-btn:hover {
            background: linear-gradient(to bottom, #666, #444);
            transform: scale(1.05);
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.2);
        }

        .collapse-btn-exp {
            background: linear-gradient(to bottom, #1A2935, #333);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            margin: 8px 0;
            transition: all 0.3s;
            font-size: 14px;
            text-transform: uppercase;
            border: 1px solid #666;
            text-shadow: 1px 1px 0 #000;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            font-family: 'Chakra Petch', sans-serif;
        }
        
        .collapse-btn-exp:hover {
            background: linear-gradient(to bottom, #666, #444);
            transform: scale(1.05);
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.2);
        }
 /* drops an limited time codes an more button ish  |||||||||||||||||||||||||*/          
        .collapse-btn-Perm {
                        display: block;
            width: fit-content;
            background: linear-gradient(to bottom, #f70, #A0F);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
margin: 10px auto;
            transition: all 0.3s;
            font-size: 14px;
            text-transform: uppercase;
            border: 1px solid #666;
            text-shadow: 1px 1px 0 #000;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            font-family: 'Chakra Petch', sans-serif;
        }
        
        .collapse-btn-Perm:hover {
            background: linear-gradient(to bottom, #F90, #A4F);
            transform: scale(1.05);
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.2);
        }       
 
 /* New Black Market button style  |||||||||||||||||||||||||*/       
.collapse-btn-BlackMarket { 
                display: block;
                            width: fit-content;
            background: linear-gradient(to bottom, #CC0000, #800000); /* Red */
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            margin: 10px auto;
            transition: all 0.3s;
            font-size: 14px;
            text-transform: uppercase;
            border: 1px solid #FF4444; /* Brighter red border */
            text-shadow: 1px 1px 0 #000;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            font-family: 'Chakra Petch', sans-serif;
        }
        
        .collapse-btn-BlackMarket:hover {
            background: linear-gradient(to bottom, #FF0000, #600000); /* Brighter red on hover */
            transform: scale(1.05);
            box-shadow: 0 0 8px rgba(255, 68, 68, 0.4); /* Red glow */
        }

            /* Style for the container inside the Black Market dropdown */
        #black-market-codes-container {
            background: linear-gradient(135deg, #4d0000, #2d0000); /* Dark red/black, matching the button's concept */
            border: 2px solid #ff4444; /* Red border */
            padding: 15px; /* Add padding for content */
            border-radius: 4px; /* Match container border-radius */
            margin-top: 8px; /* Spacing from heading */
            box-shadow: 0 0 8px rgba(255, 68, 68, 0.3);
            text-align: left; /* Ensure text aligns left within this box */
        }
        /* Ensure the H2 inside the black market section has appropriate styling */
        #black-market-section h2 {
            color: #ff9999; /* Lighter red for heading */
            border-bottom-color: #ff6666;
        }    
        
/* Only when permanent section is visible (has 'show' class) */
#permanent-section.show .permanent-code-box {
    background: linear-gradient(135deg, #451565, #652200);
    border: 1px solid #F90;
    box-shadow: 0 0 6px rgba(255, 153, 0, 0.6);
}

#permanent-section.show .permanent-code-box:hover {
    background: linear-gradient(135deg, #552575, #753300);
    border: 1px solid #FF6;
    box-shadow: 0 0 8px rgba(255, 255, 102, 0.8);
}

#permanent-section.show .permanent-code-text {
    color: #fff;
    text-shadow: 2px 2px 0 #000, 0 0 10px rgba(255, 255, 255, 1);
    font-weight: bold;
}

#permanent-section.show .permanent-title-container {
    color: #FFC;
    text-shadow: 2px 2px 0 #000, 0 0 5px #000;
    font-weight: bold;
}
        
        .expired-section, .permanent-section, .info-section {
            display: none;
            margin-top: 8px;
        }
        
        .expired-section.show, .permanent-section.show, .info-section.show {
            display: block;
        }
        
        .title-container {
            font-size: 14px;
            color: #ff9e40;
            margin-bottom: 8px;
            min-height: 18px;
            text-shadow: 1px 1px 0 #000;
        }
        
        .permanent-title-container {
            font-size: 11px;
            color: #ffc600;
            margin: 0 0 2px 0;
            min-height: 12px;
            text-shadow: 1px 1px 0 #000;
            line-height: 1.2;
            text-align: left;
        }
        
        .title-container a, .permanent-title-container a {
            color: #ffc600;
            text-decoration: underline;
            text-shadow: 1px 1px 0 #000;
            font-weight: bold;
        }
        
        .title-container a:hover, .permanent-title-container a:hover {
            color: #ff7c00;
        }
        
        .code-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }
        
        .permanent-code-header {
            display: flex;
            align-items: center;
            gap: 6px;
            margin-bottom: 2px;
        }
        
        .key-icon {
            font-size: 18px;
            color: #ffc600;
            text-shadow: 1px 1px 0 #000;
        }
        
        .permanent-key-icon {
            font-size: 12px;
            color: #6ba8ff;
            text-shadow: 1px 1px 0 #000, 0 0 3px rgba(107, 168, 255, 0.5);
        }
        
        .custom-icon {
            width: 16px;
            height: 16px;
            object-fit: contain;
            vertical-align: middle;
        }
        
        .permanent-custom-icon {
            width: 12px;
            height: 12px;
            object-fit: contain;
            vertical-align: middle;
        }
        
        .vault-symbol {
            font-size: 24px;
            margin-right: 10px;
            color: #ffc600;
            text-shadow: 1px 1px 0 #000, 0 0 5px rgba(255, 198, 0, 0.5);
        }
        /* css style |||||||||||||||||||||*/  
        .scanlines {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            background: linear-gradient(to bottom, 
                rgba(255, 255, 255, 0.03) 50%, 
                rgba(0, 0, 0, 0.1) 50%);
            background-size: 100% 4px;
            z-index: 999;
            opacity: 0.2;
        }
        
        .noise {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.05'/%3E%3C/svg%3E");
            z-index: 998;
            opacity: 0.1;
        }
        
        .no-codes {
            color: #ff9e40;
            padding: 20px;
            text-shadow: 1px 1px 0 #000;
        }
        
        .clearfix::after {
            content: "";
            clear: both;
            display: table;
        }
        
        .redeem-checkbox {
            display: flex;
            align-items: center;
            margin: 0;
            order: 1;
        }
        
        .redeem-checkbox input[type="checkbox"] {
            appearance: none;
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border: 2px solid #ffc600;
            border-radius: 3px;
            background: rgba(0, 0, 0, 0.3);
            position: relative;
            cursor: pointer;
            margin-right: 8px;
        }
        
        .redeem-checkbox input[type="checkbox"]:checked::before {
            content: "✓";
            position: absolute;
            color: #ffc600;
            font-size: 14px;
            font-weight: bold;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-shadow: 0 0 3px #000;
        }
        
        .redeem-checkbox label {
            color: #ffc600;
            font-size: 14px;
            cursor: pointer;
            text-shadow: 1px 1px 0 #000;
        }
        
        .redeemed {
            opacity: 0.7;
            position: relative;
        }
        
        .redeemed::after {
            content: "REDEEMED";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-15deg);
            font-size: 24px;
            font-weight: bold;
            color: #7cff7c;
            text-shadow: 2px 2px 0 #000, 0 0 10px rgba(124, 255, 124, 0.7);
            z-index: 10;
            pointer-events: none;
        }
        
        .redeemed .code-text {
            color: #7cff7c !important;
        }
        
        .permanent-redeemed {
            opacity: 0.7;
            position: relative;
        }
        
        .permanent-redeemed::after {
            content: "REDEEMED";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-15deg);
            font-size: 16px;
            font-weight: bold;
            color: #7cff7c;
            text-shadow: 2px 2px 0 #000, 0 0 10px rgba(124, 255, 124, 0.7);
            z-index: 10;
            pointer-events: none;
        }
        
        .permanent-redeemed .permanent-code-text {
            color: #7cff7c !important;
        }
        
        .expired-text {
            color: #ff4444;
            font-weight: bold;
            margin-top: 8px;
            font-size: 13px;
            text-shadow: 1px 1px 0 #400000;
        }
        
        .info-content {
            background: linear-gradient(to bottom, #555, #333);
            color: white;
            padding: 15px;
            margin: 8px 0;
            border-radius: 4px;
            text-align: left;
            border: 1px solid #666;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        .info-content p {
            margin-bottom: 10px;
            line-height: 1.5;
        }
        
        .info-content ul, .info-content ol {
            margin-left: 20px;
            margin-bottom: 10px;
        }
        
        .info-content li {
            margin-bottom: 5px;
        }
        
        .info-content a {
            color: #ffc600;
            text-decoration: underline;
            text-shadow: 1px 1px 0 #000;
        }
        
        .info-content a:hover {
            color: #ff7c00;
        }
        
        @media (max-width: 600px) {
            .social-links {
                gap: 10px;
            }
            
            .social-links a {
                font-size: 14px;
                padding: 6px 10px;
            }
        }
        .title-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 25px;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 15px;
            margin-bottom: 15px;
            border: 2px solid #ffc600;
        }

        .title-text {
            color: #ffc600;
            font-size: 24px;
            font-weight: bold;
            text-shadow: 2px 2px 0 #000, 0 0 10px rgba(255, 198, 0, 0.7);
        }

        .icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #ffc600;
        }

        .preview-btn {
            background: linear-gradient(to bottom, #4a90e2, #2a70c2);
            border: 1px solid #6ba8ff;
            color: #fff;
            padding: 6px 12px;
            border-radius: 3px;
            cursor: pointer;
            font-weight: bold;
            margin: 0;
            transition: all 0.3s;
            font-size: 12px;
            text-transform: uppercase;
            font-family: 'Chakra Petch', sans-serif;
            text-shadow: 1px 1px 0 #000;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        .preview-btn:hover {
            background: linear-gradient(to bottom, #5aa0ff, #3a80e2);
            transform: scale(1.05);
            box-shadow: 0 0 4px #6ba8ff;
        }

        .image-preview-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .image-preview-content {
            max-width: 90%;
            max-height: 90%;
            position: relative;
        }

        .image-preview-content img {
            max-width: 100%;
            max-height: 90vh;
            border: 3px solid #ffc600;
            border-radius: 5px;
        }

        .close-preview {
            position: absolute;
            top: -15px;
            right: -15px;
            background: #ff4444;
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            font-size: 20px;
            cursor: pointer;
            font-weight: bold;
        }

        /* Info content sections |||||||||||||||||||||*/
        #info-section .info-content {
            background: linear-gradient(to bottom, #555, #333);
            border: 2px solid #888;
            color: white;
        }

        #changelog-section .info-content {
            background: linear-gradient(to bottom, #6c757d, #495057);
            border: 2px solid #adb5bd;
            color: white;
        }

        #changelog-section .info-content a {
            color: #e9ecef;
            text-shadow: 0 0 5px #e9ecef;
        }

        #changelog-section .info-content a:hover {
            color: #ffffff;
        }

        #redeem-section .info-content {
            background: linear-gradient(to bottom, #00aa00, #0055aa);
            border: 2px solid #00ccff;
            color: white;
        }

        #redeem-section .info-content a {
            color: #00ffff;
            text-shadow: 0 0 5px #00ffff;
        }

        #redeem-section .info-content a:hover {
            color: #ffffff;
        }

    /* Style for the new "View Roadmap" button |||||||||||||||||||||*/
        .roadmap-button {
            background: linear-gradient(to bottom, #333, #111); /* Dark grey to black gradient */
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            margin: 1px auto 5px auto; /* Top margin, auto left/right, bottom margin */
            transition: all 0.3s;
            font-size: 14px;
            text-transform: uppercase;
            border: 1px solid #555; /* Dark grey border */
            text-shadow: 1px 1px 0 #000;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            font-family: 'Chakra Petch', sans-serif;
            display: block;
            width: fit-content;
            margin: 10px auto; /* Center horizontally, provide vertical spacing */
        }
        
        .roadmap-button:hover {
            background: linear-gradient(to bottom, #444, #222); /* Slightly lighter on hover */
            transform: scale(1.05);
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.1); /* Subtle white glow */
        }

/* Style for the new extra button inside the Black Market Vendor box |||||||||||||||||||||*/
        .black-market-extra-btn {
            background: linear-gradient(to bottom, #777, #555); /* Gray gradient */
            border: 1px solid #999;
            color: #fff;
            padding: 6px 12px;
            border-radius: 3px;
            cursor: pointer;
            font-weight: bold;
            margin-left: 10px; /* Adds space from the "View Location" button */
            transition: all 0.3s;
            font-size: 12px;
            text-transform: uppercase;
            font-family: 'Chakra Petch', sans-serif;
            text-shadow: 1px 1px 0 #000;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        .black-market-extra-btn:hover {
            background: linear-gradient(to bottom, #888, #666);
            transform: scale(1.05);
            box-shadow: 0 0 4px #aaa;
        }


                /* Container for the two small Black Market buttons */
        .black-market-buttons-group {
            display: flex;
            flex-wrap: wrap; /* Allow buttons to wrap if screen is too small */
            gap: 8px; /* Space between the two buttons */
            align-items: center;
        }

        /* Base style for small Black Market buttons */
        .bm-small-btn {
            padding: 4px 8px; /* Reduced padding */
            font-size: 10px; /* Reduced font size */
            font-weight: bold;
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
            font-family: 'Chakra Petch', sans-serif;
            text-shadow: 1px 1px 0 #000;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
            flex-shrink: 0; /* Prevent them from shrinking too much */
            line-height: 1.2; /* Adjust line height for smaller text */
        }
        
        .bm-small-btn:hover {
            transform: scale(1.03);
            box-shadow: 0 0 5px rgba(255, 255, 255, 0.3);
        }

        /* Specific style for the Static Image button */
        .bm-static-image-btn {
            background: linear-gradient(to bottom, #777, #555); /* Gray gradient */
            border: 1px solid #999;
            color: #fff;
        }

        .bm-static-image-btn:hover {
            background: linear-gradient(to bottom, #888, #666);
        }

        /* Specific style for the MapGenie button */
        .bm-mapgenie-btn {
            background: linear-gradient(to bottom, #4a90e2, #2a70c2); /* Blue gradient */
            border: 1px solid #6ba8ff;
            color: #fff;
        }

        .bm-mapgenie-btn:hover {
            background: linear-gradient(to bottom, #5aa0ff, #3a80e2);
        }

        /* Ensure .redeem-checkbox is properly ordered in the footer */
        .code-footer .redeem-checkbox {
            order: unset; /* Clears any explicit order */
            margin-left: auto; /* <--- ADD THIS to push the checkbox to the far right */
            margin-right: 0; /* Ensure no conflicting right margin */
        }

        /* === Responsive Adjustments for Black Market Vendor Buttons === |||||||||||||||||||||*/
        @media (max-width: 600px) { /* Adjust max-width as needed for your definition of "mobile" */
            .black-market-buttons-group {
                flex-direction: column; /* Stack buttons vertically */
                width: 100%; /* Ensure the group takes full width */
                gap: 5px; /* Reduce gap when stacked */
                margin-right: 0; /* Remove any lingering right margin */
            }

            .bm-small-btn {
                width: 100%; /* Make each button take full width */
                max-width: 100%; /* Ensure it doesn't exceed its container */
                margin: 0; /* Remove any external margins that might interfere */
            }

            /* Adjust the code-footer itself for mobile if buttons wrap */
            .code-footer {
                flex-direction: column; /* Stack footer elements vertically */
                align-items: flex-start; /* Align elements to the left */
                gap: 10px; /* Space between the button group and the checkbox */
            }

            .code-footer .redeem-checkbox {
                margin-left: 0; /* Remove auto-margin that pushes it right */
            }
        }


        /* New group for active code's action buttons (COPY and optional PREVIEW) |||||||||||||||||||||*/
        .active-code-buttons-group {
            display: flex;
            gap: 10px; /* Space between preview and copy buttons */
            align-items: center;
            margin-left: auto; /* Pushes this group to the far right within the footer */
        }
        
        /* Ensure default display for the overall code-footer */
        .code-footer {
            display: flex;
            justify-content: space-between; /* Pushes children to opposite ends */
            align-items: center;
            margin-top: 10px;
            padding-top: 8px;
            border-top: 1px solid rgba(255, 198, 0, 0.3);
        }

        /* Make sure the redeem checkbox explicitly stays left */
        /* This overrides any previous 'order' or 'margin-left: auto' */
        .code-footer .redeem-checkbox {
            order: unset; /* Remove any explicit order that might be set */
            margin-right: auto; /* Pushes itself to the left, allowing the button group to go right */
            margin-left: 0; /* Ensure no auto left margin interferes */
        }

        /* Ensure .small-copy-btn and .preview-btn revert to natural order/margins within their new group */
        .small-copy-btn, .preview-btn {
            order: unset; /* Remove any explicit order */
            margin: 0; /* Remove any external margins */
        }
        
        /* === Mobile Responsiveness for Active Code Footer === |||||||||||||||||||||*/
        @media (max-width: 600px) {
            /* Make the entire footer stack vertically on small screens */
            .code-footer {
                flex-direction: column;
                align-items: flex-start; /* Align contents to the left */
                gap: 10px; /* Space between stacked elements */
            }
            
            /* Make the button group stack vertically and take full width */
            .active-code-buttons-group {
                flex-direction: column;
                width: 100%;
                margin-left: 0; /* Remove auto margin when stacked */
                gap: 5px; /* Smaller gap when stacked */
            }
            
            /* Make individual buttons in the group take full width */
            .active-code-buttons-group .small-copy-btn,
            .active-code-buttons-group .preview-btn {
                width: 100%;
                max-width: 100%;
            }
            
            /* Adjust redeem checkbox margin for mobile stacking */
            .code-footer .redeem-checkbox {
                margin-right: 0; /* Remove auto-margin when stacked */
            }
        }


        /* Utility class to hide elements |||||||||||||||||||||*/
        .hidden {
            display: none !important;
        }

        /* Styling for the settings items (checkbox and label) */
        .setting-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .setting-item input[type="checkbox"] {
            appearance: none;
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border: 2px solid #ffc600;
            border-radius: 3px;
            background: rgba(0, 0, 0, 0.3);
            position: relative;
            cursor: pointer;
            margin-right: 8px;
            flex-shrink: 0; /* Prevent shrinking */
        }

        .setting-item input[type="checkbox"]:checked::before {
            content: "✓";
            position: absolute;
            color: #ffc600;
            font-size: 14px;
            font-weight: bold;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-shadow: 0 0 3px #000;
        }

        .setting-item label {
            color: #ffc600;
            font-size: 14px;
            cursor: pointer;
            text-shadow: 1px 1px 0 #000;
            line-height: 1.2;
        }

        /* New wrapper for the top-most horizontal buttons |||||||||||||||||||||*/
        .top-header-buttons {
            display: flex;
            justify-content: center; /* Center the buttons within the row */
            flex-wrap: wrap; /* Allow buttons to wrap to the next line on small screens */
            gap: 10px; /* Space between the buttons */
            margin-bottom: 20px; /* Space below the top row */
        }

        /* Style for the Black Market credit text |||||||||||||||||||||*/
        .black-market-credit {
            font-size: 11px;
            color: #bbb; /* Lighter text for credit */
            margin-top: 10px; /* Space above the footer/buttons */
            text-align: left;
            padding: 0 5px; /* Little padding to match content */
            font-weight: bold; /* <--- ADD THIS LINE */
        }

        .black-market-credit a {
            color: #428bca; /* Gold color for links */
            text-decoration: underline;
        }

/* Hide any label that follows a checked checkbox within redeem-checkbox  |||||||||||||||||||||*/
.redeem-checkbox input:checked + label {
    display: none;
}

    </style>
</head>
<div id="image-preview-modal" class="image-preview-modal">
    <div class="image-preview-content">
        <button class="close-preview" onclick="closeImagePreview()">×</button>
        <div id="preview-container" style="display: none;">
    </div>
        <img id="preview-image" src="" alt="Preview" style="display: none;">
    </div>
</div>
<body>
    <div class="noise"></div>
    <div class="scanlines"></div>
    
    <div class="container">
        <div class="title-bar">
            <img src="https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png" alt="Left Icon" class="icon">
            <div class="title-text">SHiFT Code Tracker  + More</div>
            <img src="https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png" alt="Right Icon" class="icon">
        </div>
        
        <div class="social-links">
            <a href="https://x.com/xsmashx88x" target="_blank">🐦 Twitter</a>
            <a href="https://discord.com/users/97484502628052992" target="_blank">💬 Discord</a>
            <a href="https://www.reddit.com/user/smashcanuckgamer/" target="_blank">👾 Reddit</a>
        </div>



<!-- NEW SETTINGS BUTTON AND SECTION (Place it here or where you prefer it visually) -->
<button class="info-button" onclick="toggleInfo('settings-section')" id="hideem-toggle-btn">🙈 Hide Buttons</button>

        <div id="settings-section" class="info-section">
            <div class="info-content">
                <h3>Visibility Settings</h3>
                <p>Choose which elements to hide:</p>
                <div class="setting-item">
                    <input type="checkbox" id="hide-redeem-toggle-btn" onchange="handleSettingChange('redeem-toggle-btn', this.checked)">
                    <label for="hide-redeem-toggle-btn">Hide "How To Redeem" button</label>
                </div>
                <div class="setting-item">
                    <input type="checkbox" id="hide-roadmap-btn" onchange="handleSettingChange('roadmap-btn', this.checked)">
                    <label for="hide-roadmap-btn">Hide "View BL4 Roadmap" button</label>
                </div>
                <div class="setting-item">
                    <input type="checkbox" id="hide-maurices-toggle-btn" onchange="handleSettingChange('maurices-toggle-btn', this.checked)">
                    <label for="hide-maurices-toggle-btn">Hide "Mauric's Black Market" button</label>
                </div>
                 <div class="setting-item">
                    <input type="checkbox" id="hide-permanent-toggle-btn" onchange="handleSettingChange('permanent-toggle-btn', this.checked)">
                    <label for="hide-permanent-toggle-btn">Hide "[View] Drops + Limited Time Codes + More" button</label>
                </div>
            </div>
        </div>

<button class="info-button" onclick="toggleInfo('info-section')" id="infofaq-toggle-btn">❗ INFO & F.A.Q. ❓</button>

        <div id="info-section" class="info-section">
            <div class="info-content">
                <p><strong>MSG To People Thinking I Want Followers/Money (I Don't) SMFH</strong></p>
                <ul>
                    <li><i>This was not done for followers or fame, its to help people, it sucks to be reported on reddit/fb an few other places :(</i></li>
                    <li><i>Some have wanted to donate/tip, sadly I can't don't wanna deal with chargebacks if I am a few mins last on posting codes :(</i></li>            
                </ul>
                <p><strong>F.A.Q</strong></p>
                <ul>
                    <li><b>Why Was This Made :</b> <i>For peeps to know if codes are expired and be able to copy them more easy via the button</i></li>
                    <li><b>How are codes put here? :</b> <i>All me, I watch randy's twitter or see them around the net and add them, No auto grab system here</i></li>            
                </ul>
                <p><strong>PSA</strong></p>
                <ul>
                    <li><b>Gold Keys On Multi Systems :</b><i>if linked multi systems can redeem on each :) from what I hear</i></li>
                </ul>
            </div>
        </div>

<button class="info-button" onclick="toggleInfo('changelog-section')" id="changlog-toggle-btn">📋 CHANGE LOG 🛠️</button>

        <div id="changelog-section" class="info-section">
            <div class="info-content">
                <p><strong>Change Log | Last Updated : 9/26/2025</strong></p>
                <ul>
                    <li><b>9/26/2025:</b> Fixed/Added : Few Things... Might or Might Not Notice :)</li>                    
                    <li><b>9/25/2025:</b> Fixed : Should Be More Mobile Friendly</li>
                    <li><b>9/25/2025:</b> Added : Hide Buttons Option (should stick on refresh)</li>  
                    <li><b>9/25/2025:</b> Fixed : Mobile Button Issues For Black Market</li>                     
                    <li><b>9/25/2025:</b> Added : Maurices Black Market, Static View</li>  
                    <li><b>9/25/2025:</b> Added : Maurices Black Market, With Map View</li>                     
                    <li><b>9/24/2025:</b> Fixed time issues</li>            
                    <li><b>9/24/2025:</b> Fixed refresh issue on Android/some browsers</li>
                    <li><b>9/23/2025:</b> Added "Mark as redeemed" feature with local storage</li>
                    <li><b>9/22/2025:</b> Added preview button for image rewards</li>
                    <li><b>9/21/2025:</b> Improved countdown timer functionality</li>
                    <li><b>9/20/2025:</b> Added permanent/unknown expiration codes section</li>
                    <li><b>9/19/2025:</b> Initial website launch with basic functionality</li>
                </ul>
            </div>
        </div>

        <button class="info-button redeem-button" onclick="toggleInfo('redeem-section')" id="redeem-toggle-btn">
            🖥️ HOW TO REDEEM ON CONSOLE 🎮
        </button>

        <div id="redeem-section" class="info-section">
            <div class="info-content">
                <p><strong>In-Game</strong></p>
                <ol>
                    <li>Open the Pause Menu while in-game Or On Main Menu</li>
                    <li>Click "SHiFT"</li>
                    <li>Click "Rewards"</li>
                    <li>Enter codes and redeem them</li>
                </ol>
                <p><strong>Online</strong></p>
                <p>CLICK THAT BUTTON BELOW AND WILL OPEN THE SHIFT REDEEM SITE</p>
            </div>
        </div>

        <div>
            <a href="https://shift.gearboxsoftware.com/rewards" target="_blank" class="rewards-link">
                🔗 CLICK HERE | TO REDEEM CODES 🌐        <br>
        <small style="font-size: 0.9em; opacity: 0.6; color: black;">Opens Official SHIFT Rewards Site</small>
            </a>
        </div>

        <button class="roadmap-button" onclick="openRoadmapImage()" id="roadmap-btn">🗺️ VIEW BL4 ROADMAP 🛣️</button>
        <!-- END NEW ROADMAP BUTTON -->

      <button class="collapse-btn-BlackMarket" onclick="toggleInfo('black-market-section')" id="maurices-toggle-btn">💵 Maurices Black Market 🫰</button>
        
        <div id="black-market-section" class="info-section">
            <h2>💵 Maurices Black Market 🫰</h2>
            <div id="black-market-codes-container">
                <!-- Black Market Vendor will be inserted here by JavaScript -->
            </div>
        </div>

        <button class="collapse-btn-Perm" onclick="togglePermanent()" id="permanent-toggle-btn">
            🎁 [View] Drops + Limited Time Codes + More ⌛    <br>
<small style="font-size: 0.9em; opacity: 0.9; color: #14F8FF;">!Updated 9/26/2025!</small>
        </button>
        
        <div id="permanent-section" class="permanent-section">
            <h2>🎁 Drops + Limited Time Codes + More ⌛</h2>
            <div id="permanent-codes-container">
                <!-- Permanent codes will be inserted here by JavaScript -->
            </div>
        </div>

        <h2>👍 Active BL4 SHiFT Codes (New At Top) 🗝️ <small style="font-size: 0.7em; opacity: 0.8;"> </small>
        </button></h2>
        <div id="active-codes-container">
            <!-- Active codes will be inserted here by JavaScript -->
        </div>

        <button class="collapse-btn-exp" onclick="toggleExpired()">
            ❌ Expired Codes 😭
        </button>
        
        <div id="expired-section" class="expired-section">
            <h2>❌ Expired Codes : Damn Look At Them All 👎</h2>
            <div id="expired-codes-container">
                <!-- Expired codes will be inserted here by JavaScript -->
            </div>
        </div>
    </div>

    <script>
// ==================== 12-HOUR FORMAT HELPER ====================
// This function correctly handles 12-hour AM/PM and 1-indexed months (1=Jan, 12=Dec).
function createDate(year, month, day, hour, minute, second, isPM) {
    // Convert 12-hour format to 24-hour format
    let hour24 = hour;
    if (isPM && hour < 12) {
        hour24 = hour + 12;
    } else if (!isPM && hour === 12) {
        hour24 = 0; // 12 AM = 0 hours
    }
    // Month is 0-indexed in JavaScript (0=January, 11=December)
    return new Date(year, month - 1, day, hour24, minute, second);
}

// ==================== CONFIGURATION ====================
const ALL_CODES_CONFIG = [
    {
        code: "BHRBJ-ZWHT3-W6JBK-BT3BB-CW3ZK",
        expires: createDate(2025, 9, 26, 4, 19, 0, 1), // 4:19 PM
        title: '1 Gold Key - <a href="https://x.com/DuvalMagic/status/1970946292131188745" target="_blank">Via Twit</a> | 9/24/2025',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png",
        showCopyButton: true
    },
    {
        code: "JSX3J-B6SBJ-CXTBC-B3T3B-BZZZT",
        expires: createDate(2025, 9, 26, 4, 19, 0, 1), // 4:19 PM
        title: '1 Gold Key - <a href="https://x.com/DuvalMagic/status/1970946292131188745" target="_blank">Via Twit</a> | 9/24/2025',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png"
    },
    {
        code: "BHFJ3-WXHBB-W63JK-B33B3-5HX95",
        expires: createDate(2025, 9, 26, 4, 19, 0, 1), // 4:19 PM
        title: '1 Gold Key- <a href="https://x.com/DuvalMagic/status/1970946292131188745" target="_blank">Via Twit</a> | 9/24/2025',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png"
    },
    {
        code: "J9XBB-KK9T3-CRTBW-BBT3T-KTBTW",
        expires: createDate(2025, 9, 24, 12, 28, 0, 1), // 12:28 PM
        title: '1 Gold Key - <a href="https://x.com/DuvalMagic/status/1970163226441547832" target="_blank">Via Twit</a>',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png",
        showCopyButton: true
    },
    {
        code: "JHFTJ-R5HBT-KF3TK-TBJT3-JJTHH",
        expires: createDate(2025, 9, 24, 12, 28, 0, 1), // 12:28 PM
        title: '1 Gold Key - <a href="https://x.com/DuvalMagic/status/1970163226441547832" target="_blank">Via Twit</a>',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png"
    },
    {
        code: "T9RJB-BFKRR-3RBTW-B33TB-KCZB9",
        expires: createDate(2025, 10, 1, 0, 0, 0, 1), // Fixed: September 1, 2025 (month is 0-indexed)
        title: '1 Gold Key',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png"
    },
    {
        code: "THRBT-WW6CB-56TB5-3B3BJ-XBW3X",
        expires: createDate(2025, 9, 30, 0, 0, 0, 1), // Fixed: September 30, 2025 (month is 0-indexed)
        title: '1 Gold Key',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png"
    },
    {
        code: "3H63J-Z3S3J-KR3BK-BTJ33-ZWKTK",
        expires: createDate(2025, 9, 22, 12, 36, 0, 1), // 12:36 PM
        title: '1 Gold Key - <a href="https://x.com/DuvalMagic/status/1969440522528792653" target="_blank">Via Twit</a>',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png"
    },
    {
        code: "TSR3B-J5S3T-KRBJW-BTTBJ-JRCXX",
        expires: createDate(2025, 9, 22, 12, 36, 0, 1), // 12:36 PM
        title: '1 : Gold Key - <a href="https://x.com/DuvalMagic/status/1969440522528792653" target="_blank">Via Twit</a>',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png"
    },
    {
        code: "3ZXJB-53STT-56T3W-B3TT3-HTS95",
        expires: createDate(2025, 9, 21, 11, 58, 1, 1), // 11:58 AM
        title: '1 Gold Key - <a href="https://x.com/DuvalMagic/status/1969068501215170641" target="_blank">Via Twit</a>',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png"
    },
    {
        code: "BSRT3-FTZBJ-K6BTW-JB3T3-WXT99",
        expires: createDate(2025, 9, 21, 11, 58, 1, 1), // 11:58 AM
        title: '1 Gold Key - <a href="https://x.com/DuvalMagic/status/1969068501215170641" target="_blank">Via Twit</a>',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png"
    },
    {
        code: "B9XT3-HX6TT-W6BBW-TTJT3-JTFKX",
        expires: createDate(2025, 9, 10, 12, 0, 0, 0), // September 10, 2025, 12:00 PM (no isPM specified, defaults to AM)
        title: "1 Gold Key",
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png"
    },              
    {
        code: "39RTT-3ZR3T-5FJBK-3J3J3-C5CRT",
        expires: createDate(2025, 9, 10, 12, 0, 0, 0), // September 10, 2025, 12:00 PM
        title: "1 Gold Key",
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png"
    },          
    {
        code: "WHWJB-XH3SX-39CZW-H3BBB-BTF55",
        expires: createDate(2025, 9, 10, 12, 0, 0, 0), // September 10, 2025, 12:00 PM
        title: "1 Gold Key",
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png"
    },          
    {
        code: "3SR3J-CS63T-CFB3K-J3JTT-RZ5JR",
        expires: createDate(2025, 9, 10, 12, 0, 0, 0), // September 10, 2025, 12:00 PM
        title: "1 Gold Key",
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png"
    },
    {
        code: "3SRBB-X9RBJ-CRTBW-3BBB3-KJFW6",
        expires: createDate(2025, 9, 10, 12, 0, 0, 0), // September 10, 2025, 12:00 PM
        title: "1 Gold Key",
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png"
    },
    {
        code: "WEWJB-XH3SX-39CZW-H3BBB-BPF55",
        expires: createDate(2025, 9, 20, 12, 0, 0, 0), // September 20, 2025, 12:00 PM
        title: '1 Gold Key - Requires linked My2K Games account - <a href="https://shift.gearboxsoftware.com/associations" target="_blank">Associate Account</a>',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png"
    }       
];

const PERMANENT_CODES = [
        {
        code: "Discord  |  Borderlands Bundles + Single Items | 9/26/2025",
        title: 'Click On Shop, Look for the Borderlands 4 Image or Scroll down and will find it. <br>Items Range from $10.99CAD to $5.99CAD Being The Lowest<br><br>NO ETA ON WHEN IT GOES AWAY, COULD BE A WEEK OR MONTH OR MONTHS FROM NOW<br><br> [Click the preview button to see video of the effects]',
        icon: "🎁",
        showCopyButton: false,
        showPreviewButton: true,
        imagePreview: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/gh-pages/smaller%20%20cbr%20%20%20%202025-09-26%2012-09-25_1.mp4",
    },
    {
        code: "Twitch Drops 1 : Watch, Drop, and Roll ECHO-4 Drone Skin cosmetic",
        title: '<a href="https://borderlands.2k.com/twitch-drops/" target="_blank">Read About It Here Or Via Info Below</a><br><br>August 29, 2025 - September 29, 2025<br><br>• Watch any livestream in the Borderlands 4 category on the official <a href="http://twitch.tv/Borderlands" target="_blank">Borderlands 4 Twitch channel</a> or <a href="https://www.twitch.tv/gearboxofficial" target="_blank">Gearbox Twitch channel</a> for 20 minutes and claim the reward',
        icon: "🎁",
        showCopyButton: false,
        showPreviewButton: true,
        imagePreview: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/BL4_Echobot_Drop_Wide_textless.png",
        expires: createDate(2025, 9, 29, 0, 0, 0, 0) // September 29, 2025, midnight AM (explicitly set to avoid default issues)
    },
    {
        code: "Twitch Drops 2 : Forsaken Chaos Legendary shotgun",
        title: '<a href="https://borderlands.2k.com/twitch-drops/" target="_blank">Read About It Here Or Via Info Below</a><br><br>September 11, 2025 - September 30, 2025<br><br>• Watch any Borderlands 4 Twitch livestream in the <a href="https://www.twitch.tv/directory/category/borderlands-4" target="_blank">Borderlands 4 category</a> for 2 hours and claim the reward',
        icon: "🎁",
        showCopyButton: false,
        showPreviewButton: true,
        imagePreview: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/BL4_ForsakenChaos.png",
        expires: createDate(2025, 9, 30, 0, 0, 0, 0) // September 30, 2025, midnight AM
    },
    {
        code: "Twitch Drops 3 : Midnight Defiance Legendary sniper rifle",
        title: '<a href="https://borderlands.2k.com/twitch-drops/" target="_blank">Read About It Here Or Via Info Below</a><br><br>September 11, 2025 - September 30, 2025<br><br>• Watch any Borderlands 4 Twitch livestream in the <a href="https://www.twitch.tv/directory/category/borderlands-4" target="_blank">Borderlands 4 category</a> hosted by a <a href="https://borderlands.2k.com/borderlands-4/partnered-creators/" target="_blank">partnered creator</a> for 2 hours and claim the reward',
        icon: "🎁",
        showCopyButton: false,
        showPreviewButton: true,
        imagePreview: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/BL4_MidnightDefiance.png",
        expires: createDate(2025, 9, 30, 0, 0, 0, 0) // September 30, 2025, midnight AM
    },
    {
        code: "JS63J-JSCWJ-CFTBW-3TJ3J-WJS5R",
        title: 'Break Free cosmetics pack and Legendary Ripper shield <br><br>• [Break Free] Vault Hunter Skin (for Vex, Rafa, Amon, and Harlowe)<br>• [Firebreak] Legendary Ripper Shield (with minimum level of 25)<br>• [Break Free] ECHO-4 Drone Skin<br>• [Kn0x] ECHO-4 Drone Skin',
        icon: "🎁",
        showCopyButton: true,
        showPreviewButton: true,
        imagePreview: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/breakfree.png",
        expires: createDate(2030, 12, 31, 0, 0, 0, 0) // Fixed: December 31, 2030, midnight AM
    },
    {
        code: "Butterfinger ECHO-4 Drone Skin",
        title: 'This shift code is can be acquired in two ways<br>Enter the  <a href="https://www.gamewithbutterfinger.com/home?path=Echo4" target="_blank">Butterfinger x Borderlands 4 online sweepstakes. </a> Note that theres no guarantee this will be available after September 2025. (US Only) <br> By purchasing the <a href="https://www.gamestop.com/collectibles/collectors-boxes/products/borderlands-4-echo-4-bundle-gamestop-exclusive/426330.html" target="_blank">GameStop Madrinas Coffee Collectors Box (US Only).</a> <br><i>USE A VPN, then search and use a fake usa number/address gen, if live outside the usa, Its what I did and I  got emailed the key :)</i>',
        icon: "🍫",
        showCopyButton: false,
        showPreviewButton: true,
        imagePreview: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/butter%20fingers%20skin.png",
        expires: createDate(2025, 9, 22, 0, 0, 0, 0) // September 22, 2025, midnight AM
    }
];

// ==================== BLACK MARKET VENDOR SYSTEM ====================
const BLACK_MARKET_VENDOR = {
    code: "Black Market Vendor",
    title: 'Maurices Black Market - Refreshes every Thursday at 12:00 AM EDT',
    icon: "🎁",
    showCopyButton: false,
    showPreviewButton: true,
    mapGenieLocation: "https://mapgenie.io/borderlands-4/maps/kairos?embed=light&catIds=13472", // Renamed for clarity
    staticImageLocation: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/BL4-Black-Market-Location-003-Grindstone-of-the-Worthysep25-oct2.jpg",
    staticImageCredit: 'Static Image From : <a href="https://mentalmars.com/borderlands-4/loot/black-market/" target="_blank">MentalMars (Check Them Out)</a>',
    type: 'weekly-vendor'

};
const ROADMAP_CONFIG = {
    imageUrl: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/roadmap.png", // <--- CHANGE THIS TO YOUR ACTUAL ROADMAP IMAGE URL
};
const BLACK_MARKET_EXTRA_CONFIG = {
    imageUrl: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/BL4-Black-Market-Location-003-Grindstone-of-the-Worthysep25-oct2.jpg", // <--- !!! REPLACE THIS WITH THE ACTUAL IMAGE URL !!!
};
        // =======================================================  

// Helper for Black Market Vendor's weekly refresh
        function getNextVendorRefresh() {
            const now = new Date();
            const nextRefresh = new Date(now);
            
            // Set target day (Thursday = 4) and time (12:00 AM)
            const targetDay = 4; // Thursday (Sunday is 0, Monday is 1, ..., Saturday is 6)
            const targetHour = 0; // 12 AM
            const targetMinute = 0;
            
            // Calculate days until next Thursday
            let daysUntilTarget = (targetDay + 7 - now.getDay()) % 7;
            
            // If it's the same day, check if time has passed
            if (daysUntilTarget === 0) {
                if (now.getHours() > targetHour || 
                    (now.getHours() === targetHour && now.getMinutes() >= targetMinute)) {
                    daysUntilTarget = 7; // Move to next week if time has passed
                }
            }
            
            // Set the next refresh date
            nextRefresh.setDate(now.getDate() + daysUntilTarget);
            nextRefresh.setHours(targetHour, targetMinute, 0, 0);
            
            return nextRefresh;
        }

        function createBlackMarketVendorBox() {
            const nextRefresh = getNextVendorRefresh();
            const now = new Date();
            const timeLeft = nextRefresh.getTime() - now.getTime(); // Use getTime for accurate comparison
            
            const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
            const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
            
            const iconHtml = createIconHtml(BLACK_MARKET_VENDOR.icon, false);
            
            // Get redemption status for the black market vendor
            const isRedeemed = getBlackMarketRedemptionStatus();
            const redeemedClass = isRedeemed ? 'redeemed' : '';

            return `
                <div class="black-market-code-box ${redeemedClass}" id="black-market-vendor">
                    <div class="code-header">
                        ${iconHtml}
                        <div class="title-container">${BLACK_MARKET_VENDOR.title}</div>
                    </div>
                    <div class="code-text">Black Market Vendor</div>
                    <div class="expire-date">Next refresh: ${formatDate(nextRefresh, 'Refreshes:')}</div>
                    <div class="countdown">Refreshes in: ${days}d ${hours}h ${minutes}m ${seconds}s</div>
                ${BLACK_MARKET_VENDOR.staticImageCredit ? `<div class="black-market-credit">${BLACK_MARKET_VENDOR.staticImageCredit}</div>` : ''}
<div class="code-footer">
                        <div class="black-market-buttons-group"> <!-- Now this is first -->
                            <button class="bm-small-btn bm-static-image-btn" onclick="openImagePreview('${BLACK_MARKET_VENDOR.staticImageLocation}')">
                                📍 View Location (STATIC IMAGE) | IS CURRENT
                            </button>
                            <button class="bm-small-btn bm-mapgenie-btn" onclick="openImagePreview('${BLACK_MARKET_VENDOR.mapGenieLocation}')">
                                📍 View Location (MAPGENIE) | MIGHT BE SLOW/WRONG
                            </button>
                        </div>
                        <div class="redeem-checkbox"> <!-- Now this is second -->
                            <input type="checkbox" id="bm-redeemed" ${isRedeemed ? 'checked' : ''} 
                                onchange="handleBlackMarketRedemptionChange(this, document.getElementById('black-market-vendor'))">
                            <label for="bm-redeemed">💰</label>
                        </div>
                    </div>
            `;
        }

        function updateVendorTimer() {
            const vendorBox = document.getElementById('black-market-vendor');
            if (!vendorBox) return; // Exit if the vendor box isn't currently displayed

            const nextRefresh = getNextVendorRefresh();
            const now = new Date();
            const timeLeft = nextRefresh.getTime() - now.getTime();
            
            // Handle case where refresh just occurred
            if (timeLeft <= 0) {
                // Clear redemption status for the new week
                localStorage.removeItem('blackMarketRedeemed'); 
                console.log("Black Market Vendor refreshed and redemption status cleared. Reloading page...");
                location.reload();
                return;
            }
            
            const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
            const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
            
            const countdownElement = vendorBox.querySelector('.countdown');
            const expireDateElement = vendorBox.querySelector('.expire-date');
            
            if (countdownElement) {
                countdownElement.textContent = `Refreshes in: ${days}d ${hours}h ${minutes}m ${seconds}s`;
            }
            if (expireDateElement) {
                // Use formatDate for consistent display
                expireDateElement.textContent = `Next refresh: ${formatDate(nextRefresh, 'Refreshes:')}`; 
            }
        }

        // Make sure to call updateVendorTimer regularly (e.g., every second)
        setInterval(updateVendorTimer, 1000);

function openImagePreview(url) {
    const modal = document.getElementById('image-preview-modal');
    const imageElement = document.getElementById('preview-image');
    const container = document.getElementById('preview-container');
    
    // Hide both first
    imageElement.style.display = 'none';
    container.style.display = 'none';
    
    // Image formats
    if (url.match(/\.(jpeg|jpg|gif|png|svg|webp|bmp)$/i)) {
        // It's an image - use the existing image element
        imageElement.src = url;
        imageElement.style.display = 'block';
        imageElement.alt = "Preview";
    } 
    // Video formats
    else if (url.match(/\.(mp4|webm|ogg|mov|avi|mkv|flv|wmv|m4v|3gp)$/i)) {
        // It's a video - use the container with video element
        container.innerHTML = `
            <video controls autoplay style="width: 800px; height: auto; max-width: 90vw; max-height: 80vh; border: 2px solid #ffc600; border-radius: 5px;">
                <source src="${url}" type="video/mp4">
                <source src="${url}" type="video/webm">
                <source src="${url}" type="video/ogg">
                Your browser does not support the video tag.
            </video>
        `;
        container.style.display = 'block';
    } else {
        // It's a website - use the container with iframe
        container.innerHTML = `
            <iframe src="${url}" style="width: 800px; height: 600px; max-width: 90vw; max-height: 80vh; border: 2px solid #ffc600; border-radius: 5px;" 
                    onerror="showPreviewFallback('${url}')">
            </iframe>
        `;
        container.style.display = 'block';
    }
    
    modal.style.display = 'flex';
}

        // --- NEW: Function to open the Roadmap image ---
function openRoadmapImage() {
    openImagePreview(ROADMAP_CONFIG.imageUrl);
}

        function showPreviewFallback(url) {
            const container = document.getElementById('preview-container');
            container.innerHTML = `
                <div style="color: white; text-align: center; padding: 40px;">
                    <h3>🌐 Cannot Embed Website</h3>
                    <p>Click below to open in new tab:</p>
                    <button onclick="window.open('${url}', '_blank'); closeImagePreview();" 
                            style="background: #ffc600; color: black; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer;">
                        Open MapGenie
                    </button>
                </div>
            `;
        }

        function closeImagePreview() {
            document.getElementById('image-preview-modal').style.display = 'none';
        }

        // Close when clicking outside
        document.addEventListener('click', function(e) {
            if (e.target.id === 'image-preview-modal') {
                closeImagePreview();
            }
        });

        function toggleInfo(sectionId) {
            const section = document.getElementById(sectionId);
            section.classList.toggle('show');
        }

        function toggleExpired() {
            const expiredSection = document.getElementById('expired-section');
            expiredSection.classList.toggle('show');
        }

        function togglePermanent() {
            const permanentSection = document.getElementById('permanent-section');
            permanentSection.classList.toggle('show');
        }

        function copyToClipboard(text, index, type) {
            navigator.clipboard.writeText(text).then(() => {
                const message = document.getElementById(`copied-${type}-${index}`);
                if (message) {
                    message.style.display = 'inline';
                    setTimeout(() => {
                        message.style.display = 'none';
                    }, 2000);
                }
            }).catch(err => {
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                
                const message = document.getElementById(`copied-${type}-${index}`);
                if (message) {
                    message.style.display = 'inline';
                    setTimeout(() => {
                        message.style.display = 'none';
                    }, 2000);
                }
            });
        }

        function saveRedemptionStatus(code, isRedeemed) {
            try {
                const redeemedCodes = JSON.parse(localStorage.getItem('shiftRedeemedCodes')) || {};
                redeemedCodes[code] = isRedeemed;
                localStorage.setItem('shiftRedeemedCodes', JSON.stringify(redeemedCodes));
            } catch (e) {
                console.error("Error saving to localStorage:", e);
            }
        }

        function getRedemptionStatus(code) {
            try {
                const redeemedCodes = JSON.parse(localStorage.getItem('shiftRedeemedCodes')) || {};
                return redeemedCodes[code] || false;
            } catch (e) {
                console.error("Error reading from localStorage:", e);
                return false;
            }
        }

        function handleRedemptionChange(code, checkbox, container) {
            const isRedeemed = checkbox.checked;
            saveRedemptionStatus(code, isRedeemed);
            
            if (isRedeemed) {
                container.classList.add('redeemed');
            } else {
                container.classList.remove('redeemed');
            }
        }

        function handlePermanentRedemptionChange(code, checkbox, container) {
            const isRedeemed = checkbox.checked;
            saveRedemptionStatus(code, isRedeemed);
            
            if (isRedeemed) {
                container.classList.add('permanent-redeemed');
            } else {
                container.classList.remove('permanent-redeemed');
            }
        }

        // New functions for Black Market Vendor redemption status
        function saveBlackMarketRedemptionStatus(isRedeemed) {
            try {
                localStorage.setItem('blackMarketRedeemed', JSON.stringify(isRedeemed));
            } catch (e) {
                console.error("Error saving Black Market redemption status to localStorage:", e);
            }
        }

        function getBlackMarketRedemptionStatus() {
            try {
                const status = localStorage.getItem('blackMarketRedeemed');
                return status ? JSON.parse(status) : false;
            } catch (e) {
                console.error("Error reading Black Market redemption status from localStorage:", e);
                return false;
            }
        }

        function handleBlackMarketRedemptionChange(checkbox, container) {
            const isRedeemed = checkbox.checked;
            saveBlackMarketRedemptionStatus(isRedeemed);
            
            if (isRedeemed) {
                container.classList.add('redeemed');
            } else {
                container.classList.remove('redeemed');
            }
        }

        function isImageUrl(str) {
            return str.match(/\.(jpeg|jpg|gif|png|svg|webp)$/i) !== null;
        }

        function createIconHtml(icon, isPermanent = false) {
            if (!icon) return isPermanent ? '<span class="permanent-key-icon">🔑</span>' : '<span class="key-icon">🔑</span>';
            
            if (isImageUrl(icon)) {
                const className = isPermanent ? 'permanent-custom-icon' : 'custom-icon';
                return `<img src="${icon}" class="${className}" alt="Icon">`;
            } else {
                const className = isPermanent ? 'permanent-key-icon' : 'key-icon';
                return `<span class="${className}">${icon}</span>`;
            }
        }

        // --- MODIFIED organizeCodes function for robust date comparison and error handling ---
        function organizeCodes() {
            const now = new Date();
            const nowTimestamp = now.getTime(); // Get timestamp once for consistent comparison
            const regularActiveCodes = [];
            const permanentActiveCodes = [];
            const expiredCodes = [];

            // Process ALL_CODES_CONFIG (regular codes)
            ALL_CODES_CONFIG.forEach(codeData => {
                let expiresDate;
                try {
                    expiresDate = (codeData.expires instanceof Date) ? codeData.expires : new Date(codeData.expires);
                } catch (e) {
                    console.error(`Error parsing expires date for regular code "${codeData.code}":`, codeData.expires, e);
                    // If parsing fails, treat as expired for safety to ensure it doesn't stay active.
                    expiredCodes.push(codeData);
                    return;
                }

                // Check for "Invalid Date" resulting from parsing
                if (isNaN(expiresDate.getTime())) {
                    console.error("Invalid expires date for regular code (isNaN check):", codeData.code, codeData.expires);
                    // If invalid, assume it's malformed data and treat as expired for safety.
                    expiredCodes.push(codeData);
                    return;
                }

                // Compare timestamps for precise expiration check
                if (expiresDate.getTime() > nowTimestamp) {
                    regularActiveCodes.push(codeData);
                } else {
                    expiredCodes.push(codeData);
                }
            });

            // Process PERMANENT_CODES
            PERMANENT_CODES.forEach(codeData => {
                let expiresDate = null;
                if (codeData.expires) {
                    try {
                        expiresDate = (codeData.expires instanceof Date) ? codeData.expires : new Date(codeData.expires);
                    } catch (e) {
                        console.error(`Error parsing expires date for permanent code "${codeData.code}":`, codeData.expires, e);
                        // If parsing fails for a permanent code with an expiry, treat as active
                        // to prevent it from being incorrectly expired due to bad data.
                        permanentActiveCodes.push(codeData);
                        return;
                    }

                    // Check for "Invalid Date" resulting from parsing
                    if (isNaN(expiresDate.getTime())) {
                        console.error("Invalid expires date for permanent code (isNaN check):", codeData.code, codeData.expires);
                        // If invalid, treat as active to prevent incorrect expiration due to bad data.
                        permanentActiveCodes.push(codeData);
                        return;
                    }
                }
                
                // No expiration, or expires in the future (compare timestamps)
                if (!expiresDate || expiresDate.getTime() > nowTimestamp) {
                    permanentActiveCodes.push(codeData);
                } else { // Has expiration and it's <= now (compare timestamps)
                    expiredCodes.push({
                        ...codeData,
                        wasPermanent: true // Flag to indicate it was originally permanent
                    });
                }
            });
            
            return { regularActiveCodes, permanentActiveCodes, expiredCodes };
        }

        function formatDate(date) {
            // Ensure the date object is valid before formatting
            if (!date || isNaN(date.getTime())) {
                return "Invalid Date";
            }
            // Convert to user's local time with clear timezone info
            const userLocalTime = date.toLocaleString('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                timeZoneName: 'short'
            });
            
            // Get the user's timezone
            const userTimezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
            
            return `${userLocalTime} (Your Timezone: ${userTimezone})`; 
        }

        function createPermanentCodeBox(codeData, index) {
            const hasCopyButton = codeData.showCopyButton !== false;
            const hasPreviewButton = codeData.showPreviewButton;
            const isRedeemed = getRedemptionStatus(codeData.code);
            const redeemedClass = isRedeemed ? 'permanent-redeemed' : '';
            const iconHtml = createIconHtml(codeData.icon, true);
            
            let countdownHtml = '';
            let expiresDate = null;

            if (codeData.expires) {
                try {
                    expiresDate = (codeData.expires instanceof Date) ? codeData.expires : new Date(codeData.expires);
                    if (isNaN(expiresDate.getTime())) {
                         console.error("Invalid expires date in createPermanentCodeBox for:", codeData.code, codeData.expires);
                         expiresDate = null; // Treat as no expiration if invalid
                    }
                } catch (e) {
                    console.error("Error parsing expires date in createPermanentCodeBox for:", codeData.code, codeData.expires, e);
                    expiresDate = null;
                }
            }

            if (expiresDate) {
                const timeLeft = expiresDate.getTime() - new Date().getTime();
                if (timeLeft > 0) {
                    const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
                    countdownHtml = `<div class="countdown">Time left: ${days}d ${hours}h ${minutes}m</div>`;
                }
            }
            
            let copyButtonHtml = '';
            if (hasCopyButton) {
                copyButtonHtml = `
                    <button class="permanent-copy-btn" onclick="copyToClipboard('${codeData.code}', ${index}, 'permanent')">
                        COPY
                    </button>
                    <span id="copied-permanent-${index}" class="permanent-copied-message">✓ Copied!</span>
                `;
            }
            
            let previewButtonHtml = '';
            if (hasPreviewButton && codeData.imagePreview) { 
                previewButtonHtml = `
                    <button class="preview-btn" onclick="openImagePreview('${codeData.imagePreview}')">
                        📷 PREVIEW
                    </button>
                `;
            }
            
            return `
                <div class="permanent-code-box clearfix ${redeemedClass}" id="permanent-${index}">
                    <div class="permanent-code-header">
                        ${iconHtml}
                        <div class="permanent-code-text">${codeData.code}</div>
                    </div>
                    <div class="permanent-title-container">${codeData.title}</div>
                    ${expiresDate ? `<div class="expire-date">Expires: ${formatDate(expiresDate)}</div>` : ''}
                    ${countdownHtml}
                    <div class="permanent-code-footer">
                        <div class="redeem-checkbox">
                            <input type="checkbox" id="permanent-redeemed-${index}" ${isRedeemed ? 'checked' : ''} 
                                onchange="handlePermanentRedemptionChange('${codeData.code}', this, document.getElementById('permanent-${index}'))">
                            <label for="permanent-redeemed-${index}">🎁</label>
                        </div>
                        ${copyButtonHtml}
                        ${previewButtonHtml}
                    </div>
                </div>
            `;
        }

        function createActiveCodeBox(codeData, index) {
            const hasCopyButton = codeData.showCopyButton !== false;
            const hasPreviewButton = codeData.showPreviewButton;
            let expiresDate;
            try {
                expiresDate = (codeData.expires instanceof Date) ? codeData.expires : new Date(codeData.expires);
                if (isNaN(expiresDate.getTime())) {
                    console.error("Invalid expires date in createActiveCodeBox for:", codeData.code, codeData.expires);
                    expiresDate = new Date(0); // Set to an arbitrary past date if invalid
                }
            } catch (e) {
                console.error("Error parsing expires date in createActiveCodeBox for:", codeData.code, codeData.expires, e);
                expiresDate = new Date(0); // Set to an arbitrary past date if error
            }

            const timeLeft = expiresDate.getTime() - new Date().getTime();
            const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
            const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
            const isRedeemed = getRedemptionStatus(codeData.code);
            const redeemedClass = isRedeemed ? 'redeemed' : '';
            const iconHtml = createIconHtml(codeData.icon, false);
            
            let copyButtonHtml = '';
            if (hasCopyButton) {
                copyButtonHtml = `
                    <button class="small-copy-btn" onclick="copyToClipboard('${codeData.code}', ${index}, 'active')">
                        COPY
                    </button>
                    <span id="copied-active-${index}" class="copied-message">✓ Copied!</span>
                `;
            }
            
            let previewButtonHtml = '';
            if (hasPreviewButton && codeData.imagePreview) { 
                previewButtonHtml = `
                    <button class="preview-btn" onclick="openImagePreview('${codeData.imagePreview}')">
                        📷 PREVIEW
                    </button>
                `;
            }
            
            return `
                <div class="code-box ${redeemedClass}" id="active-${index}">
                    <div class="code-header">
                        ${iconHtml}
                        <div class="title-container">${codeData.title}</div>
                    </div>
                    <div class="code-text">${codeData.code}</div>
                    <div class="expire-date">Expires: ${formatDate(expiresDate)}</div>
                    <div class="countdown">Time left: ${days}d ${hours}h ${minutes}m</div>
<div class="code-footer">
                <div class="redeem-checkbox">
                    <input type="checkbox" id="redeemed-${index}" ${isRedeemed ? 'checked' : ''} 
                        onchange="handleRedemptionChange('${codeData.code}', this, document.getElementById('active-${index}'))">
                    <label for="redeemed-${index}">👍</label>
                </div>
                <!-- NEW: Wrapper for copy and preview buttons. Preview button comes first if both exist. -->
                <div class="active-code-buttons-group">
                    ${previewButtonHtml} 
                    ${copyButtonHtml}
                </div>
            </div>
            `;
        }

        function createExpiredCodeBox(codeData, index) {
            const hasPreviewButton = codeData.showPreviewButton;
            const isRedeemed = getRedemptionStatus(codeData.code);
            const redeemedClass = isRedeemed ? 'redeemed' : '';
            const iconHtml = createIconHtml(codeData.icon, false);
            
            let previewButtonHtml = '';
            if (hasPreviewButton && codeData.imagePreview) { 
                previewButtonHtml = `
                    <button class="preview-btn" onclick="openImagePreview('${codeData.imagePreview}')">
                        📷 PREVIEW
                    </button>
                `;
            }
            
            let expiresDate;
            try {
                expiresDate = (codeData.expires instanceof Date) ? codeData.expires : new Date(codeData.expires);
                if (isNaN(expiresDate.getTime())) {
                    console.error("Invalid expires date in createExpiredCodeBox for:", codeData.code, codeData.expires);
                    expiresDate = new Date(); // Use current date as fallback if invalid
                }
            } catch (e) {
                console.error("Error parsing expires date in createExpiredCodeBox for:", codeData.code, codeData.expires, e);
                expiresDate = new Date(); // Use current date as fallback if error
            }

            return `
                <div class="expired-code-box ${redeemedClass}" id="expired-${index}">
                    <div class="code-header">
                        ${iconHtml}
                        <div class="title-container">${codeData.title}</div>
                    </div>
                    <div class="code-text">${codeData.code}</div>
                    <div class="expire-date">Expired: ${formatDate(expiresDate)}</div>
<div class="code-footer">
                <div class="redeem-checkbox">
                    <input type="checkbox" id="expired-redeemed-${index}" ${isRedeemed ? 'checked' : ''} 
                        onchange="handleRedemptionChange('${codeData.code}', this, document.getElementById('expired-${index}'))">
                    <label for="expired-redeemed-${index}">👎</label>
                </div>
                <!-- NEW: Wrapper for copy and preview buttons (reusing active-code-buttons-group for consistent styling) -->
                <div class="active-code-buttons-group">
                    ${previewButtonHtml} 
                    <button class="small-copy-btn" onclick="copyToClipboard('${codeData.code}', ${index}, 'expired')">
                        COPY
                    </button>
                    <span id="copied-expired-${index}" class="copied-message">✓ Copied!</span>
                </div>
            </div>
                    <div class="expired-text">❌ EXPIRED</div>
                </div>
            `;
        }

        function updateCountdowns() {
            const now = new Date();
            const nowTimestamp = now.getTime();
            
            // Update active codes
            const activeContainers = document.querySelectorAll('#active-codes-container .code-box');
            activeContainers.forEach((container) => {
                const countdownElement = container.querySelector('.countdown');
                const codeTextElement = container.querySelector('.code-text');
                
                if (!countdownElement || !codeTextElement) return;
                
                const codeText = codeTextElement.textContent;
                // Find the correct code data from ALL_CODES_CONFIG (excluding the vendor for this loop)
                const codeData = ALL_CODES_CONFIG.find(code => code.code === codeText);
                
                // Skip if no codeData or expires found
                if (!codeData || !codeData.expires) {
                    return;
                }
                
                let expireDate;
                try {
                    expireDate = (codeData.expires instanceof Date) ? codeData.expires : new Date(codeData.expires);
                    if (isNaN(expireDate.getTime())) {
                        console.error("Invalid expires date in updateCountdowns (active) for:", codeData.code, codeData.expires);
                        countdownElement.textContent = 'Invalid Date';
                        countdownElement.style.color = '#ff4444';
                        return;
                    }
                } catch (e) {
                    console.error("Error parsing expires date in updateCountdowns (active) for:", codeData.code, codeData.expires, e);
                    countdownElement.textContent = 'Error Date';
                    countdownElement.style.color = '#ff4444';
                    return;
                }

                const timeLeft = expireDate.getTime() - nowTimestamp;
                
                if (timeLeft <= 0) {
                    countdownElement.textContent = 'EXPIRED';
                    countdownElement.style.color = '#ff4444';
                    // Note: This only updates the text. To *move* the box, you'd need more complex DOM manipulation
                    // or re-initialize the page which happens on a full refresh.
                } else {
                    const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
                    
                    countdownElement.textContent = `Time left: ${days}d ${hours}h ${minutes}m ${seconds}s`;
                    countdownElement.style.color = '#ff7c00';
                }
            });
            
            // Update permanent codes countdowns
            const permanentContainers = document.querySelectorAll('#permanent-codes-container .permanent-code-box');
            permanentContainers.forEach((container) => {
                const countdownElement = container.querySelector('.countdown');
                const codeTextElement = container.querySelector('.permanent-code-text');
                
                if (!countdownElement || !codeTextElement) return;
                
                const codeText = codeTextElement.textContent;
                const codeData = PERMANENT_CODES.find(code => code.code === codeText);
                
                if (!codeData || !codeData.expires) {
                    // If permanent code has no expiration or it's not found, clear countdown if present
                    if (countdownElement) countdownElement.textContent = ''; 
                    return;
                }
                
                let expireDate;
                try {
                    expireDate = (codeData.expires instanceof Date) ? codeData.expires : new Date(codeData.expires);
                    if (isNaN(expireDate.getTime())) {
                        console.error("Invalid expires date in updateCountdowns (permanent) for:", codeData.code, codeData.expires);
                        countdownElement.textContent = 'Invalid Date';
                        countdownElement.style.color = '#ff4444';
                        return;
                    }
                } catch (e) {
                    console.error("Error parsing expires date in updateCountdowns (permanent) for:", codeData.code, codeData.expires, e);
                    countdownElement.textContent = 'Error Date';
                    countdownElement.style.color = '#ff4444';
                    return;
                }

                const timeLeft = expireDate.getTime() - nowTimestamp;
                
                if (timeLeft <= 0) {
                    countdownElement.textContent = 'EXPIRED';
                    countdownElement.style.color = '#ff4444';
                } else {
                    const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
                    
                    countdownElement.textContent = `Time left: ${days}d ${hours}h ${minutes}m ${seconds}s`;
                    countdownElement.style.color = '#ff7c00';
                }
            });
        }

        // ==================== AUTO CACHE DETECTION ====================
function getCodesHash() {
    // Include all code configs and the Black Market vendor's next refresh time
    const allCodesData = [...ALL_CODES_CONFIG, ...PERMANENT_CODES]; 
    const hashString = allCodesData.map(code => 
        code.code + (code.expires ? (new Date(code.expires).getTime() || '') : '')
    ).join('|');

    // Add the next vendor refresh time to the hash to ensure refresh on vendor change
    const nextVendorRefreshTimestamp = getNextVendorRefresh().getTime();
    return btoa(hashString + `|VendorRefresh:${nextVendorRefreshTimestamp}`).substring(0, 32); 
}

        function checkCodesVersion() {
            const currentHash = getCodesHash();
            const savedHash = localStorage.getItem('shiftCodesHash');
            
            if (savedHash !== currentHash) {
                // Codes have changed - update and refresh
                localStorage.setItem('shiftCodesHash', currentHash);
                console.log('Codes updated, refreshing page...');
                location.reload();
                return true; // Page will refresh
            }
            
            return false; // No changes, continue normally
        }

function initializePage() {
    const permanentContainer = document.getElementById('permanent-codes-container');
    const activeContainer = document.getElementById('active-codes-container');
    const expiredContainer = document.getElementById('expired-codes-container');
    // NEW: Get reference to the black market container
    const blackMarketContainer = document.getElementById('black-market-codes-container'); 
    
    // Clear containers before adding new content to prevent duplicates on re-initialization
    console.log('Clearing containers...');
    permanentContainer.innerHTML = '';
    activeContainer.innerHTML = '';
    expiredContainer.innerHTML = '';
    blackMarketContainer.innerHTML = ''; // Clear the new black market container
    console.log('Containers cleared.');

    const { regularActiveCodes, permanentActiveCodes, expiredCodes } = organizeCodes();
    
    console.log('Organized Codes - Regular Active:', regularActiveCodes.length);
    console.log('Organized Codes - Permanent Active:', permanentActiveCodes.length);
    console.log('Organized Codes - Expired:', expiredCodes.length);
    
    // NEW: Add Black Market Vendor to its dedicated container
    blackMarketContainer.innerHTML += createBlackMarketVendorBox(); 
    
    // Then add regular active codes (no vendor here anymore)
    if (regularActiveCodes.length > 0) {
        regularActiveCodes.forEach((codeData, index) => {
            activeContainer.innerHTML += createActiveCodeBox(codeData, index);
        });
    } else {
        // Updated message for active codes, assuming no vendor here now
        activeContainer.innerHTML += '<div class="no-codes">No active regular codes at the moment. Check back later, Vault Hunter!</div>';
    }
    
    // Render active permanent codes
    if (permanentActiveCodes.length > 0) {
        permanentActiveCodes.forEach((codeData, index) => {
            permanentContainer.innerHTML += createPermanentCodeBox(codeData, index);
        });
    } else {
        permanentContainer.innerHTML += '<div class="no-codes">No permanent codes available at this time.</div>';
    }
    
    // Show expired codes (including expired permanent ones)
    if (expiredCodes.length > 0) {
        expiredCodes.forEach((codeData, index) => {
            expiredContainer.innerHTML += createExpiredCodeBox(codeData, index);
        });
    } else {
        expiredContainer.innerHTML += '<div class="no-codes">No expired codes to display.</div>';
    }
    
    updateCountdowns(); // Initial call to display correct times immediately
    // THIS LINE MUST BE PRESENT for active countdowns
    setInterval(updateCountdowns, 1000); 
    setInterval(updateVendorTimer, 1000); // Keep this for the Black Market Vendor

        applyDisplayPreferences();
}

        document.addEventListener('DOMContentLoaded', () => {
            // Run version check, if codes changed, page will reload.
            // If not, initializePage will be called.
            if (!checkCodesVersion()) {
                initializePage();
            }
            // Start countdowns and vendor timer once, they manage their own intervals.
            // updateCountdowns is called by initializePage.
            // updateVendorTimer has its own setInterval.
        });

        // --- NEW: Functions for User Display Preferences ---
        function saveDisplayPreference(elementId, isHidden) {
            try {
                const preferences = JSON.parse(localStorage.getItem('userDisplayPreferences')) || {};
                preferences[elementId] = isHidden; // Store true if hidden, false if visible
                localStorage.setItem('userDisplayPreferences', JSON.stringify(preferences));
            } catch (e) {
                console.error("Error saving display preference to localStorage:", e);
            }
        }

        function getDisplayPreference(elementId) {
            try {
                const preferences = JSON.parse(localStorage.getItem('userDisplayPreferences')) || {};
                // Default to false (not hidden) if no preference is saved
                return preferences[elementId] || false; 
            } catch (e) {
                console.error("Error reading display preference from localStorage:", e);
                return false;
            }
        }

        function applyDisplayPreferences() {
            const controlledElements = ['settings-toggle-btn', 'redeem-toggle-btn', 'roadmap-btn', 'maurices-toggle-btn', 'permanent-toggle-btn'];

            controlledElements.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    const isHidden = getDisplayPreference(id);
                    element.classList.toggle('hidden', isHidden); // Add/remove 'hidden' class
                    
                    // Also update the state of the checkbox in the settings panel
                    const checkbox = document.getElementById(`hide-${id}`);
                    if (checkbox) {
                        checkbox.checked = isHidden;
                    }
                }
            });
        }

        function handleSettingChange(elementId, isHidden) {
            saveDisplayPreference(elementId, isHidden);
            applyDisplayPreferences(); // Re-apply all preferences immediately
        }
        // --- END NEW FUNCTIONS ---

    </script>
</body>
</html>
